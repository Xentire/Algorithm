求组合数Ⅰ(数据范围1≤n≤10000,  1≤b≤a≤2000)

例题:https://www.acwing.com/problem/content/887/

给定 n 组询问，每组询问给定两个整数 a，b，请你输出 Cbamod(109+7) 的值。

输入格式
第一行包含整数 n。

接下来 n 行，每行包含一组 a 和 b。

输出格式
共 n 行，每行输出一个询问的解。

数据范围
1≤n≤10000,
1≤b≤a≤2000
输入样例：
3
3 1
5 3
2 2
输出样例：
3
10
1

#include <iostream>
#include <algorithm>
#include <cstring>
using namespace std;
const int N = 2010,MOD = 1e9 + 7;
int arr[N][N];
int n;
void init()
{
    for(int i = 0;i < N;i++)
    {
        for(int j = 0;j <= i;j++)
        {
            if(!j) arr[i][j] = 1;
            else arr[i][j] = (arr[i - 1][j] + arr[i - 1][j - 1]) % MOD;
        }
    }
}

int main()
{
    cin >> n;
    init();
    while(n--)
    {
        int a,b;
        cin >> a >> b;
        cout << arr[a][b] << endl;
    }
    
    
    return 0; 
}

算法核心:
因为a和b的数值不大最高只有2000，可以直接预处理出来组合数数组

求组合数Ⅱ(数据范围1≤n≤10000 ,1≤b≤a≤105)

例题:https://www.acwing.com/problem/content/888/

给定 n 组询问，每组询问给定两个整数 a，b，请你输出 Cbamod(109+7) 的值。

输入格式
第一行包含整数 n。

接下来 n 行，每行包含一组 a 和 b。

输出格式
共 n 行，每行输出一个询问的解。

数据范围
1≤n≤10000,
1≤b≤a≤105
输入样例：
3
3 1
5 3
2 2
输出样例：
3
10
1

#include <iostream>
#include <algorithm>
#include <cstring>
using namespace std;
const int N = 1e5 + 10,MOD = 1e9 + 7;
int fact[N],infact[N];
int n;
typedef long long LL;
int qmi(int a,int b,int p)
{
    int res = 1;
    while(b)
    {
        if(b & 1) res = (LL)res * a % p;
        b >>= 1;
        a = (LL)a * a % p;
    }
    return res;
}

int main()
{
    cin >> n;
    fact[0] = 1,infact[0] = 1;
    for(int i = 1;i < N;i++)
    {
        fact[i] = (LL)fact[i - 1] * i % MOD;
        infact[i] = (LL)infact[i - 1] * qmi(i,MOD - 2,MOD) % MOD;
    }
    while(n--)
    {
        int a,b;
        cin >> a >> b;
        cout << (LL)fact[a] * infact[b] % MOD * infact[a - b] % MOD << endl;
    }
    
    
    
    return 0;
}

算法核心:
因为a和b的范围非常大 数据达到了1e5,而两重循环n^2的复杂度在1e5的数据下会超时所以不能用预处理组合数数组的方式来求
而且1e5的数据二维数组也会mle
可以预处理出阶乘数组，阶乘只需要一层循环就可以算出来
然后使用阶乘来求解组合数

组合数Ⅲ(数据范围1≤n≤20 ,1≤b≤a≤1018,1≤p≤105)

例题:https://www.acwing.com/problem/content/889/

给定 n 组询问，每组询问给定三个整数 a,b,p，其中 p 是质数，请你输出 Cbamodp 的值。

输入格式
第一行包含整数 n。

接下来 n 行，每行包含一组 a,b,p。

输出格式
共 n 行，每行输出一个询问的解。

数据范围
1≤n≤20,
1≤b≤a≤1018,
1≤p≤105,

输入样例：
3
5 3 7
3 1 5
6 4 13
输出样例：
3
3
2

#include <iostream>
#include <algorithm>
#include <cstring>
using namespace std;
typedef long long LL;

int qmi(int a,int b,int p)
{
    int res = 1;
    while(b)
    {
        if(b & 1) res = (LL)res * a % p;
        b >>= 1;
        a = (LL)a * a % p;
    }
    return res;
}

int C(int a,int b,int p)
{
    if(b > a) return 0;
    int res = 1;
    for(int i = 1,j = a;i <= b;i++,j--)
    {
        res = (LL)res * j % p;
        res = (LL)res * qmi(i,p - 2,p) % p;
    }
    return res;
}

int Lucas(LL a,LL b,int p)
{
    if(a < p && b < p) return C(a,b,p); 
    return (LL)Lucas(a / p,b / p,p) * C(a % p,b % p,p) % p;
}
int main()
{
    int n;
    cin >> n;
    while(n--)
    {
        LL a,b;
        int p;
        cin >> a >> b >> p;
        cout << Lucas(a,b,p) << endl;
    }
    return 0;
}

算法核心:
Lucas定理
Cab = C(a % p)(b % p) * C(a / p)(b / p)
此题因为a和b是long long类型 数据过大 不能再使用预处理阶乘来解决 故使用Lucas定理

组合数Ⅳ

例题:https://www.acwing.com/problem/content/890/

输入 a,b，求 Cba 的值。

注意结果可能很大，需要使用高精度计算。

输入格式
共一行，包含两个整数 a 和 b。

输出格式
共一行，输出 Cba 的值。

数据范围
1≤b≤a≤5000
输入样例：
5 3
输出样例：
10

